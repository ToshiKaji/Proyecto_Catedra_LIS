CREATE DATABASE lis_pro;

CREATE TABLE `Clientes` (
	`UserCli` varchar(100) NOT NULL UNIQUE,
    `Correo` varchar(100) NOT NULL UNIQUE,
	`PwCli` varchar(100) NOT NULL,
	`Nombre` TEXT NOT NULL,
	`Apellido` TEXT NOT NULL,
	`DUI` varchar(100) NOT NULL UNIQUE,
    `HashVer` varchar(100) NOT NULL UNIQUE,
    `Activo` int(1) NOT NULL DEFAULT 0,
	PRIMARY KEY (`UserCli`)
);

CREATE TABLE `Empresas` (
	`CodRubro` varchar(100)NOT NULL,
	`UserEmpr` varchar(100) NOT NULL UNIQUE,
	`PwEmpr` varchar(100) NOT NULL UNIQUE,
	`Email` varchar(100) NOT NULL UNIQUE,
	`NmEmpresa` varchar(100) NOT NULL,
	`Direccion` varchar(100) NOT NULL,
	`Telefono` varchar(100) NOT NULL,
	`NmContacto` varchar(100) NOT NULL,
	`Comision` DECIMAL(4) NOT NULL,
	PRIMARY KEY (`UserEmpr`)
);

CREATE TABLE `CuponesGenerados` (
	`Cliente` varchar(100) NOT NULL,
	`DUI_Cliente` varchar(100) NOT NULL,
	`Cupon` varchar(100) NOT NULL,
	`CCgenerado` varchar(100) NOT NULL UNIQUE,
	`EstadoCanjeo` bool NOT NULL
);

CREATE TABLE `Rubros` (
	`CodRubro` varchar(100) NOT NULL,
	`Rubro` TEXT(100) NOT NULL,
	PRIMARY KEY (`CodRubro`)
);

CREATE TABLE `Empleado` (
	`Empresa` varchar(100) NOT NULL,
	`Nombre` varchar(100) NOT NULL,
	`Apellido` varchar(100) NOT NULL,
	`Email` varchar(100) NOT NULL UNIQUE
);

CREATE TABLE  `cupones` (
  `id_cupon` int(11) NOT NULL AUTO_INCREMENT,
  `titulo_oferta` varchar(100) NOT NULL,
  `descripcion` varchar(200) NOT NULL,
  `precio_regular` decimal(7,2) NOT NULL,
  `porcentaje_oferta` decimal(7,2) NOT NULL,
  `empresa` varchar(100) NOT NULL,
  `fecha_ini_oferta` datetime NOT NULL,
  `fecha_fin_oferta` datetime NOT NULL,
  `fecha_limite` datetime NOT NULL,
  `porc_cargo_servicio` decimal(3,2) NOT NULL,
  `condiciones` varchar(250) NOT NULL,
  `cantidad` int(11) NOT NULL,
  `cantidad_total` int(11) NOT NULL,
  `id_rubro` int(11) NOT NULL,
  `img` varchar(250) NOT NULL,
  `estado` int(11) NOT NULL,
  PRIMARY KEY (`id_cupon`)
)



ALTER TABLE `Empresas` ADD CONSTRAINT `Empresas_fk0` FOREIGN KEY (`CodRubro`) REFERENCES `Rubros`(`CodRubro`);

ALTER TABLE `CuponesGenerados` ADD CONSTRAINT `CuponesGenerados_fk0` FOREIGN KEY (`Cliente`) REFERENCES `Clientes`(`UserCli`);

ALTER TABLE `Empleado` ADD CONSTRAINT `Empleado_fk0` FOREIGN KEY (`Empresa`) REFERENCES `Empresas`(`UserEmpr`);