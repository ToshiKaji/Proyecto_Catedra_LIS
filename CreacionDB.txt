CREATE DATABASE lis_pro;

CREATE TABLE `OfertasCupones` (
	`EmpresaOff` varchar(100) NOT NULL DEFAULT false,
	`Estado` bool NOT NULL DEFAULT false,
	`Vigencia` bool NOT NULL DEFAULT false,
	`Condiciones` TEXT NOT NULL,
	`FInicio` DATE NOT NULL,
	`FFinal` DATE NOT NULL,
	`Oferta` TEXT NOT NULL,
	`PrecioNormal` FLOAT NOT NULL,
	`PrecioOferta` FLOAT NOT NULL,
	`LimiteCupones` int,
	`CodOferta` varchar(100) NOT NULL,
	`Precio` FLOAT NOT NULL DEFAULT false,
	`CantVendida` int NOT NULL DEFAULT false,
	`TotalIngresos` FLOAT NOT NULL DEFAULT false,
	`CargoServicio` FLOAT NOT NULL DEFAULT false,
	PRIMARY KEY (`CodOferta`)
);

CREATE TABLE `Clientes` (
	`UserCli` varchar(100) NOT NULL UNIQUE,
    `Correo` varchar(100) NOT NULL UNIQUE,
	`PwCli` varchar(100) NOT NULL,
	`Nombre` TEXT NOT NULL,
	`Apellido` TEXT NOT NULL,
	`DUI` varchar(100) NOT NULL UNIQUE,
    `HashVer` varchar(100) NOT NULL UNIQUE,
    `Activo` int(1) NOT NULL DEFAULT 0,
	PRIMARY KEY (`UserCli`)
);

CREATE TABLE `Empresas` (
	`CodRubro` varchar(100)NOT NULL,
	`UserEmpr` varchar(100) NOT NULL UNIQUE,
	`PwEmpr` varchar(100) NOT NULL UNIQUE,
	`Email` varchar(100) NOT NULL UNIQUE,
	`NmEmpresa` varchar(100) NOT NULL,
	`Direccion` varchar(100) NOT NULL,
	`Telefono` varchar(100) NOT NULL,
	`NmContacto` varchar(100) NOT NULL,
	`Comision` DECIMAL(4) NOT NULL,
	PRIMARY KEY (`UserEmpr`)
);

CREATE TABLE `CuponesGenerados` (
	`Cliente` varchar(100) NOT NULL,
	`DUI_Cliente` varchar(100) NOT NULL,
	`Cupon` varchar(100) NOT NULL,
	`CCgenerado` varchar(100) NOT NULL UNIQUE,
	`EstadoCanjeo` bool NOT NULL
);

CREATE TABLE `Rubros` (
	`CodRubro` varchar(100) NOT NULL,
	`Rubro` TEXT(100) NOT NULL,
	PRIMARY KEY (`CodRubro`)
);

CREATE TABLE `Empleado` (
	`Empresa` varchar(100) NOT NULL,
	`Nombre` varchar(100) NOT NULL,
	`Apellido` varchar(100) NOT NULL,
	`Email` varchar(100) NOT NULL UNIQUE
);


ALTER TABLE `OfertasCupones` ADD CONSTRAINT `OfertasCupones_fk0` FOREIGN KEY (`EmpresaOff`) REFERENCES `Empresas`(`UserEmpr`);

ALTER TABLE `Empresas` ADD CONSTRAINT `Empresas_fk0` FOREIGN KEY (`CodRubro`) REFERENCES `Rubros`(`CodRubro`);

ALTER TABLE `CuponesGenerados` ADD CONSTRAINT `CuponesGenerados_fk0` FOREIGN KEY (`Cliente`) REFERENCES `Clientes`(`UserCli`);

ALTER TABLE `CuponesGenerados` ADD CONSTRAINT `CuponesGenerados_fk1` FOREIGN KEY (`Cupon`) REFERENCES `OfertasCupones`(`CodOferta`);

ALTER TABLE `Empleado` ADD CONSTRAINT `Empleado_fk0` FOREIGN KEY (`Empresa`) REFERENCES `Empresas`(`UserEmpr`);